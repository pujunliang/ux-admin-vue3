import{d as V,aM as s,av as q,bo as p,r as k,o as v,c as y,t as b,G as S,b as f,w as g,u as D,bN as E,a as F,aP as M,at as P,aq as R,e as z}from"./index-56d49eb9.js";import{_ as G}from"./_plugin-vue_export-helper-c27b6911.js";const I={class:"card filter"},K={key:0,class:"title sle"},O={class:"el-tree-node__label"},U=V({name:"TreeFilter"}),$=V({...U,props:{requestApi:{},data:{},title:{},id:{default:"id"},label:{default:"label"},multiple:{type:Boolean,default:!1},defaultValue:{}},emits:["change"],setup(C,{expose:N,emit:h}){const l=C,w={children:"children",label:l.label},n=s(),r=s([]),d=s([]),u=s(),m=()=>{l.multiple?u.value=Array.isArray(l.defaultValue)?l.defaultValue:[l.defaultValue]:u.value=typeof l.defaultValue=="string"?l.defaultValue:""};q(async()=>{if(m(),l.requestApi){const{data:e}=await l.requestApi();r.value=e,d.value=[{id:"",[l.label]:"全部"},...e]}}),p(()=>l.defaultValue,()=>R(()=>m()),{deep:!0,immediate:!0}),p(()=>l.data,()=>{var e;(e=l.data)!=null&&e.length&&(r.value=l.data,d.value=[{id:"",[l.label]:"全部"},...l.data])},{deep:!0,immediate:!0});const c=s("");p(c,e=>{n.value.filter(e)});const T=(e,i,a)=>{if(!e)return!0;let o=a.parent,t=[a.label],_=1;for(;_<a.level;)t=[...t,o.label],o=o.parent,_++;return t.some(B=>B.indexOf(e)!==-1)},x=e=>{l.multiple||h("change",e[l.id])},A=()=>{var e;h("change",(e=n.value)==null?void 0:e.getCheckedKeys())};return N({treeData:r,treeAllData:d,treeRef:n}),(e,i)=>{const a=k("el-input"),o=k("el-scrollbar");return v(),y("div",I,[e.title?(v(),y("h4",K,b(e.title),1)):S("",!0),f(a,{modelValue:c.value,"onUpdate:modelValue":i[0]||(i[0]=t=>c.value=t),placeholder:"请输入关键字...",clearable:""},null,8,["modelValue"]),f(o,{style:P({height:e.title?"calc(100% - 95px)":"calc(100% - 56px)"})},{default:g(()=>[f(D(E),{ref_key:"treeRef",ref:n,"default-expand-all":"","node-key":e.id,data:e.multiple?r.value:d.value,"show-checkbox":e.multiple,"check-strictly":!1,"current-node-key":e.multiple?"":u.value,"highlight-current":!e.multiple,"expand-on-click-node":!1,"check-on-click-node":e.multiple,props:w,"filter-node-method":T,"default-checked-keys":e.multiple?u.value:[],onNodeClick:x,onCheck:A},{default:g(t=>[F("span",O,[M(e.$slots,"default",{row:t},()=>[z(b(t.node.label),1)],!0)])]),_:3},8,["node-key","data","show-checkbox","current-node-key","highlight-current","check-on-click-node","default-checked-keys"])]),_:3},8,["style"])])}}});const J=G($,[["__scopeId","data-v-2ea21d75"]]);export{J as T};
